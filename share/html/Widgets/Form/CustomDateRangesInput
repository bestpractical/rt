%# BEGIN BPS TAGGED BLOCK {{{
%#
%# COPYRIGHT:
%#
%# This software is Copyright (c) 1996-2020 Best Practical Solutions, LLC
%#                                          <sales@bestpractical.com>
%#
%# (Except where explicitly superseded by other copyright notices)
%#
%#
%# LICENSE:
%#
%# This work is made available to you under the terms of Version 2 of
%# the GNU General Public License. A copy of that license should have
%# been provided with this software, but in any event can be snarfed
%# from www.gnu.org.
%#
%# This work is distributed in the hope that it will be useful, but
%# WITHOUT ANY WARRANTY; without even the implied warranty of
%# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
%# General Public License for more details.
%#
%# You should have received a copy of the GNU General Public License
%# along with this program; if not, write to the Free Software
%# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
%# 02110-1301 or visit their web page on the internet at
%# http://www.gnu.org/licenses/old-licenses/gpl-2.0.html.
%#
%#
%# CONTRIBUTION SUBMISSION POLICY:
%#
%# (The following paragraph is not intended to limit the rights granted
%# to you to modify and distribute this software under the terms of
%# the GNU General Public License and is only of importance to you if
%# you choose to contribute your changes and enhancements to the
%# community by submitting them to Best Practical Solutions, LLC.)
%#
%# By intentionally submitting any modifications, corrections or
%# derivatives to this work, or any other work intended for use with
%# Request Tracker, to Best Practical Solutions, LLC, you confirm that
%# you are the copyright holder for those contributions and you grant
%# Best Practical Solutions,  LLC a nonexclusive, worldwide, irrevocable,
%# royalty-free, perpetual, license to use, copy, create derivative
%# works based on those contributions, and sublicense and distribute
%# those contributions and any derivatives thereof.
%#
%# END BPS TAGGED BLOCK }}}

<div id="custom-date-range-input">
  <input id="CustomDateRangesUI" type="hidden" name="CustomDateRangeUI" value="" />
  <input id="CustomDateRangesUI-updated" type="hidden" name="updated" value="0" />
  <input type="hidden" name="CustomDateRangesUI-Current" value="<% RT::Config::Stringify( $Config ) %>" />
  <&|/Widgets/TitleBox, title => loc('Custom Date Ranges in [_1]', $Location ) &>
  <div id="custom-date-ranges">
    <div class="form-row input-row-header">
      <div class="col-md-2"><&|/l&>Name</&></div>
      <div class="col-md-2"><&|/l&>From</&></div>
      <div class="col-md-2"><&|/l&>From Value if Unset</&></div>
      <div class="col-md-2"><&|/l&>To</&></div>
      <div class="col-md-2"><&|/l&>To Value if Unset</&></div>
      <div class="col-md-1"><&|/l&>Business<br>Hours?</&></div>
      <div class="col-md-1">
        <input type="checkbox" name="DeleteAll" value="1" onclick="setCheckbox(this, /^\d+-Delete$/)" />
        <&|/l&>Delete</&>
      </div>
    </div>
% my $i = 0;
% if ( $Config ) {
% my $id = 0;
%   for my $name ( sort keys %{$Config->{'RT::Ticket'}} ) {
% $i++;
      <div class="form-row input-row">
        <div class="col-md-2"><input type="text" size="15" name="<% $id %>-name" value="<% $name %>" /></div>
%       my %date_range_spec = RT::Ticket->_ParseCustomDateRangeSpec($name, $Config->{'RT::Ticket'}{$name});
        <div class="col-md-2"><& /Elements/SelectCustomDateRangeField, Name => "$id-from", Default => $date_range_spec{from} &></div>
        <div class="col-md-2"><& /Elements/SelectCustomDateRangeField, Name => "$id-from_fallback", Default => $date_range_spec{from_fallback} &></div>
        <div class="col-md-2"><& /Elements/SelectCustomDateRangeField, Name => "$id-to", Default => $date_range_spec{to} &></div>
        <div class="col-md-2"><& /Elements/SelectCustomDateRangeField, Name => "$id-to_fallback", Default => $date_range_spec{to_fallback} &></div>
        <div class="col-md-1">
          <select name="<% $id %>-business_time">
            <option value="1" <% $date_range_spec{business_time} ? 'selected="selected"' : '' |n%>><&|/l&>Yes</&></option>
            <option value="0" <% $date_range_spec{business_time} ? '': 'selected="selected"' |n%>><&|/l&>No</&></option>
          </select>
        </div>
        <div class="col-md-1"><input type="checkbox" name="<% $id %>-Delete" value="1" /></div>
      </div>
%     $id++;
%   }
% }

% for ( 1 .. 3 ) {
% $i++;
      <div class="form-row input-row">
        <div class="col-md-2"><input type="text" size="15" name="name" value="" /></div>
        <div class="col-md-2"><& /Elements/SelectCustomDateRangeField, Name => 'from' &></div>
        <div class="col-md-2"><& /Elements/SelectCustomDateRangeField, Name => 'from_fallback' &></div>
        <div class="col-md-2"><& /Elements/SelectCustomDateRangeField, Name => 'to' &></div>
        <div class="col-md-2"><& /Elements/SelectCustomDateRangeField, Name => 'to_fallback' &></div>
        <div class="col-md-1">
          <select name="business_time">
            <option value="1"><&|/l&>Yes</&></option>
            <option value="0" selected="selected"><&|/l&>No</&></option>
          </select>
        </div>
        <div class="col-md-1"></div>
      </div>
% }
    </div>
  </&>
</div>
<%ARGS>
$Location
$Config
</%ARGS>

